<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>buotlearning</title><link>https://buot.learning.io/</link><description>Always looking ahead</description><atom:link href="https://buot.learning.io/rss.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><copyright>Contents © 2017 &lt;a href="mailto:robertnsfz86@gmail.com"&gt;buot&lt;/a&gt; </copyright><lastBuildDate>Mon, 13 Nov 2017 07:08:56 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Volatility Modelling in Finance Part 1</title><link>https://buot.learning.io/posts/volatility-modelling-in-finance-part-1/</link><dc:creator>buot</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Heteroscedasticity"&gt;Heteroscedasticity&lt;a class="anchor-link" href="https://buot.learning.io/posts/volatility-modelling-in-finance-part-1/#Heteroscedasticity"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;blockquote&gt;&lt;p&gt;Heteroscedasticity is a hard word to pronounce, but it doesn't need to be a difficult concept to understand. Put simply, heteroscedasticity (also spelled heteroskedasticity) refers to the circumstance in which the variability of a variable is unequal across the range of values of a second variable that predicts it.&lt;/p&gt;
&lt;p&gt;A scatterplot of these variables will often create a cone-like shape, as the scatter (or variability) of the dependent variable (DV) widens or narrows as the value of the independent variable (IV) increases. The inverse of heteroscedasticity is homoscedasticity, which indicates that a DV's variability is equal across values of an IV. 
(see reference &lt;a href="http://www.statsmakemecry.com/smmctheblog/confusing-stats-terms-explained-heteroscedasticity-heteroske.html" title="heteroscedasticity"&gt;heteroscedasticity&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;We use the &lt;strong&gt;Apple&lt;/strong&gt; stock price for a demonstration.&lt;/li&gt;
&lt;li&gt;Below is the formula for daily log return for index spot levels
$ \displaystyle Z_t = \rm{ln}~\frac{P_t}{P_{t-1}} $&lt;/li&gt;
&lt;li&gt;Below figure is Apple 5 year historical spot
&lt;img src="https://image.ibb.co/jeDvoG/apple5Y.png" alt="Apple 5Y Spot History" title="Apple 5Y Spot Data"&gt;&lt;/li&gt;
&lt;li&gt;There is also daily log return for &lt;strong&gt;Apple&lt;/strong&gt;
&lt;img src="http://image.ibb.co/dGKMvw/apple5_Ydaily_LR.png" alt="Apple 5Y Daily Log Return" title="Apple 5Y Daily Log Return"&gt;&lt;/li&gt;
&lt;li&gt;For the above figures, they can be generated with Pandas in python&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas_datareader&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pdr&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;dateutil.relativedelta&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;relativedelta&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;dateutil.relativedelta&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;relativedelta&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;apple&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'AAPL'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'yahoo'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;relativedelta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;years&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromtimestamp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1e9&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;apple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;apple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Close&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tolist&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dchange&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;First we use &lt;strong&gt;AR(p)&lt;/strong&gt; model to fit the daily log return series $\{z_t\}$ to extract shocks.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Given a time series $\{y_t\}$, the Autoregressive, i.e. &lt;em&gt;AR(p)&lt;/em&gt; , process, aims to model the conditional expectation $\rm{E}(~y_t|\mathscr{F_{t-1}}~)$ with lagged dependent variables. 
The &lt;strong&gt;AR(p)&lt;/strong&gt; model is defined as
$\displaystyle X_t = c + \sum_{i=1}^p~\phi_i X_{t-i} + \epsilon_t$
where $\phi_1, \dots, \phi_p$ are model parameters, $\epsilon_t$ is white noise and $c$ is a constant.
See reference &lt;a href="https://www.bauer.uh.edu/rsusmel/phd/ec2-3.pdf" title="Stationarity, AR(p), MA(p)"&gt;Stationary, AR(p), MA(p)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Before we proceed, we also need &lt;a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion" title="BIC Criterion"&gt;Bayesian Information Criterion&lt;/a&gt; to help determine if the daily log return time series $\{z_t\}$ has &lt;strong&gt;AR&lt;/strong&gt;, i.e. autoregression, structure. Also we need &lt;a href="https://en.wikipedia.org/wiki/Akaike_information_criterion" title="AIC Criterion"&gt;Akaike Information Criterion&lt;/a&gt; to determine &lt;strong&gt;AR&lt;/strong&gt; coefficient.&lt;/p&gt;
&lt;p&gt;If the underlying process follows &lt;strong&gt;AR&lt;/strong&gt; model, there will be a certain $p$ beyond which the &lt;em&gt;Autocorrelation Function&lt;/em&gt; (&lt;strong&gt;ACF&lt;/strong&gt;), which is defined as $\rho_k = \rm{Corr}( y_t, y_{t-t} )$, starts to either decay exponentially (&lt;strong&gt;AR(p)&lt;/strong&gt; model), or directly cuts off to become $0$ (&lt;strong&gt;MA(p)&lt;/strong&gt; model).&lt;/p&gt;
&lt;p&gt;Note that the &lt;strong&gt;ACF&lt;/strong&gt; is defined as
$\rho_k = \rm{Corr}(y_t, y_{t-k}) = \frac{\rm{Cov}(y_t, y_{t-k})}{\rm{Var}(y_t)} = \frac{\rm{E}((y_t-\mu)\cdot(y_{t-k}-\mu))}{\rm{Var}(y_t)}$
where $\mu$ is the sample mean.&lt;/p&gt;
&lt;p&gt;In general, for time series analysis on a given time series $\{y_t\}$, we wish to decide on a model to use. In order to do that, we start with analyzing auto-correlation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Auto-correlation Correlogram. &lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;&lt;p&gt;Seasonal patterns of time series can be examined via correlograms, with &lt;strong&gt;ACF&lt;/strong&gt; calculated numerically and displayed graphically. In &lt;em&gt;pandas&lt;/em&gt;, the plotting tools and &lt;em&gt;statsmodels&lt;/em&gt; graphics standardize/normalize the data before calculating the auto-correlation, in other words, they de-mean the data and divide by the standard deviation.&lt;/p&gt;
&lt;p&gt;As we mentioned earlier above, when normalizing the data, it is implicily assumed that the data is underlied by a Gaussian distribution, which is far from the truth generally.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We import first the necessary modules&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;statsmodels.api&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;&lt;p&gt;And we can use statsmodels graphics functions to visualize the autocorrelation in the spot price time series and the daily log return time series&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;211&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;graphics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_acf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;212&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;graphics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_acf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;dchange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'Apple 5Y Spot Autocorrelation'&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'Apple 5Y Daily Log Return Autocorrelation'&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src="http://image.ibb.co/huRF5w/apple5_Yacf.png" alt="Apple 5Y autocorrelation" title="Apple 5Y autocorrelation"&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;By default the &lt;em&gt;statsmodels.graphics.tsa.plot_acf&lt;/em&gt; sets the $95\%$ confidence interval. Any autocorrelation falling outside of the cone is very likely &lt;strong&gt;&lt;em&gt;not&lt;/em&gt;&lt;/strong&gt; a result of statistical coincidence.&lt;/p&gt;
&lt;p&gt;As we can observe, the price time series have very heavy autocorrelation, but the daily log return time series seems to be uncorrelated between current and lagged data points.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Partial Autocorrelation Function (&lt;strong&gt;PACF&lt;/strong&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;&lt;p&gt;This is an extention of autocorrelation, with the dependence on the intermediate elements ( those within the lag ) removed. So, in &lt;strong&gt;PACF&lt;/strong&gt; only autocorrelation between current and single lagged data points is considered.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;With both results from &lt;strong&gt;ACF&lt;/strong&gt; and &lt;strong&gt;PACF&lt;/strong&gt;, we apply below rule of thumbs to summarize our findings:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;If &lt;strong&gt;ACF&lt;/strong&gt; has exponential decay and &lt;strong&gt;PACF&lt;/strong&gt; has a spike at lag $1$ with no correlation for other lags, then we pick one autoregressive (p) parameter.&lt;/li&gt;
&lt;li&gt;If &lt;strong&gt;ACF&lt;/strong&gt; shows a sine-wave ( sinuoidal ) pattern or maybe a series of exponential decays, and &lt;strong&gt;PACF&lt;/strong&gt; has spikes at lags $1$ and $2$ with no correlation for other lags, then we use two autoregressive (p) parameters.&lt;/li&gt;
&lt;li&gt;If &lt;strong&gt;ACF&lt;/strong&gt; has spikes at lags $1$ and $2$ with no correlation for other lags, and the &lt;strong&gt;PACF&lt;/strong&gt; having sine-wave ( sinuoidal ) patterns or a series of exponential decays, then we use two &lt;em&gt;Moving Average&lt;/em&gt; (q) parameters.&lt;/li&gt;
&lt;li&gt;If &lt;strong&gt;ACF&lt;/strong&gt; shows exponential decay from lag $1$, and &lt;strong&gt;PACF&lt;/strong&gt; shows exponential decay from lag $1$, then we use one autoregressive (p) and one &lt;em&gt;Moving Average&lt;/em&gt; (q) parameters.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Consider &lt;strong&gt;PACF&lt;/strong&gt; plots now for the Apple spot and daily log return time series.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;211&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Figure&lt;/span&gt; &lt;span class="nb"&gt;object&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="mh"&gt;0x7f443f600650&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;graphics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_pacf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;212&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;graphics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_pacf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;dchange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'Apple 5Y Spot Partial Autocorrelation'&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'Apple 5Y Daily Log Return Partial Autocorrelation'&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src="http://image.ibb.co/d6gMdG/apple5_Ypacf.png" alt="Apple 5Y spot and daily log return paritial autocorrelation" title="Apple 5Y Spot and Dail Logreturn PACF"&gt;&lt;/p&gt;
&lt;p&gt;From the above we could argue that the price dynamics can be modeled by a &lt;strong&gt;AR(2)&lt;/strong&gt; process while the daily log return shows no autoregressive structure.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Removing Serial Dependency&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;&lt;p&gt;There are two primary reasons for serial dependency removal&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We can identify hidden nature of seasonal dependencies in the time series. Autocorrelations for consecutive lags are inter-dependent, so removal of some ( $1$ or $2$ ) of the autocorrelations will change the behavior of other inter-dependent autocorrelations, thus rendering seasonality pattern more apparent.&lt;/li&gt;
&lt;li&gt;Removing serial dependency is necessary for &lt;strong&gt;ARIMA&lt;/strong&gt; and other techniques by makng the time series stationary.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Durbin-Watson Statistics&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;&lt;p&gt;This is another tool to infer/reflect serial dependency/correlation.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A score of $2$ or value nearby indicates no first order serial correlation.&lt;/li&gt;
&lt;li&gt;A score higher than $2$ indicates negative serial correlation.&lt;/li&gt;
&lt;li&gt;A score below $2$ indicates positive serial correlation.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;durbin_watson&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mf"&gt;0.00020611229112895053&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;durbin_watson&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;dchange&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mf"&gt;1.9269710279008647&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As suspected, the price data for Apple has very high positive serial correlation, and close to none first order serial correlation exists for the daily log return time series.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We can also check out the &lt;strong&gt;autocorrelation_plot&lt;/strong&gt; function from &lt;em&gt;pandas&lt;/em&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pandas.tools.plotting&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;autocorrelation_plot&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;acorr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxlags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'solid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;usevlines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;''&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;autocorrelation_plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src="http://image.ibb.co/eOLmCb/apple5_Ypltacorr.png" alt="Apple 5Y Spot autocorrelation using matplotlib.pyplot.acorr" title="Apple 5Y Spot ACF using plotting acorr"&gt; &lt;img src="http://image.ibb.co/g3szXb/apple5_Ypdplottingacorr.png" alt="Apple 5Y Spot autocorrelation using pandas plotting autocorrelation_plot" title="Apple 5Y Spot pandas plotting autocorrelation_plot"&gt;&lt;/p&gt;
&lt;p&gt;Now we can do the same thing for daily log return time series&lt;/p&gt;
&lt;p&gt;&lt;img src="http://image.ibb.co/j2tjyG/apple5_YLRmatacorr.png" alt="Apple 5Y daily log return time series autocorrelation"&gt;&lt;img src="http://image.ibb.co/n07BdG/apple5_YLRpdplottingacorr.png" alt="Apple 5Y daily log return time series autocorrelation"&gt;&lt;/p&gt;
&lt;p&gt;Before moving on to measure &lt;strong&gt;BIC&lt;/strong&gt; and &lt;strong&gt;AIC&lt;/strong&gt;, here we spend some time discussing two types of time series models:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ARMA model. This model has no differencing terms. For this model to work, first the time series needs to be normalized. On subset of this ARMA model ( $q= 0$) is called autoregressive, i.e. &lt;strong&gt;AR&lt;/strong&gt;, model. Its coefficient $p$ tells people how many lagged past values are included. The simplest &lt;strong&gt;AR&lt;/strong&gt; models are AR(1) and AR(2) models, where $y_t = a_1 y_{t-1} + \epsilon_t$ is AR(1) and $y_t = a_1y_{t-1} + a_2y_{t-2} + \epsilon_t$ is AR(2). Here $\epsilon_t$ is also called &lt;strong&gt;noise, error, random shock or residual&lt;/strong&gt;. &lt;/li&gt;
&lt;li&gt;ARIMA model. This is a nonseasonal model, with coefficients $p, d, q$.  This model &lt;ul&gt;
&lt;li&gt;$p$ is the number of autoregressive terms&lt;/li&gt;
&lt;li&gt;$q$ is the number of lagged forecast errors in the prediction equation&lt;/li&gt;
&lt;li&gt;$d$ is the number of nonseasonal differences needed for stationarity&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With the above discusion we are ready to test out if Apple 5Y time series can be fit with &lt;strong&gt;AR&lt;/strong&gt; model.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;     &lt;span class="n"&gt;ar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ARMA&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;     &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bic&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aic&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_bic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_aic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_bic&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3683.9288817901738&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3678.104158860021&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3672.2616868366035&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3665.7462773627503&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3657.4673501739048&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3644.2091150706792&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3637.5476756509215&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3635.8776569718625&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3638.1377064231947&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_aic&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3699.3454827900105&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3698.659626859803&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3697.9560218363313&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3696.5794793624236&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3693.4394191735237&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3685.3200510702436&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3683.797478650431&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3687.2663269713175&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3694.6652434225953&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pprint&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pprint&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;ar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ARMA&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pricets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;disp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.5391567&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.99931284&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.52480202&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.03158641&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.0323095&lt;/span&gt; &lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.53900419&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.03260334&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.06537156&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.03208206&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.54761278&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.03188954&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.06393619&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.00912625&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.02225809&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.55570571&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.02101326&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.07248766&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.01356156&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.07540423&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
       &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.03830892&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;6.63836303e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.03241101e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.34912888e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="mf"&gt;8.09853617e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.99125120e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.03634186e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.08947797e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;6.93082732e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.03250086e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.31901076e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="mf"&gt;7.17718799e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.98007739e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.81459471e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.27698218e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;2.12953802e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;6.41537409e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.03389658e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.54572005e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="mf"&gt;6.96818414e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;4.24811788e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.44036367e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.66387200e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;8.85853766e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.53954434e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.530215&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.03617857&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.06852668&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.00821132&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.04192651&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
       &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.00532303&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.03716906&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.09101347&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.10263509&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.03561377&lt;/span&gt;&lt;span class="p"&gt;])]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both &lt;strong&gt;AIC&lt;/strong&gt; and &lt;strong&gt;BIC&lt;/strong&gt; are pretty flat across all lags from $1$ to $10$. The coefficients of lagged terms are all very small.&lt;/p&gt;
&lt;p&gt;Now with the daily log return time series, we see that&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;     &lt;span class="n"&gt;ar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ARMA&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;dchangets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;     &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bic&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aic&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_bic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_aic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_bic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_aic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_bic&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;3592.7810821078388&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3598.5002915583509&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3605.2573920134569&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3612.0740267872316&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3618.1609580250242&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3625.2937675843446&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3625.9346132411874&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3627.2298576466219&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3634.309597689964&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ts_aic&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;3577.366863005706&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3577.9479994221733&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3579.567026843235&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3581.2455885829654&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3582.194446786714&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3584.18918331199&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3579.6919559347884&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3575.8491273061786&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3577.790794315476&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;ar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tsa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ARMA&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;dchangets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;disp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;ar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt; 
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pprint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.48668166e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.47295188e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;2.40012798e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.58934053e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.35455796e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;5.55316281e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.53114722e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.29353100e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.73939838e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;  &lt;span class="mf"&gt;3.12918391e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.55889838e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.24133092e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.79483489e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.59715050e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.80750456e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.60672606e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.28614221e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.87490103e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.69640087e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.90948686e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.41927422e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;3.60089117e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.28258150e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.87855133e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.69061012e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.90198039e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.06106150e-03&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mf"&gt;0.00022074&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.03614531&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.03079878&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.02003435&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.0181938&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt;
       &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.02692235&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.00466375&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;0.07229583&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.87561568e-05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;4.10468249e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.10751608e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.16972696e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.94739717e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.84732812e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.39515925e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;7.47787834e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.85913087e-02&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
 &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;8.23967015e-06&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;4.15094277e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.15902346e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.16655310e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;1.96512688e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.85608621e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.22698844e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;7.49583817e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.88659820e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="mf"&gt;6.87112377e-03&lt;/span&gt;&lt;span class="p"&gt;])]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It's the same for daily log return time series. We see that the residual/error term ( the first one in each case ) is very small and the coefficients are all small.&lt;/p&gt;
&lt;p&gt;While lower values of AIC indicate that a model is more likely to be &lt;strong&gt;close to&lt;/strong&gt; the truth, and lower values of BIC suggests a model is more likely to be the true, we find that for all the lag values tested, none of them seem to be standing out to be closer to true model ( &lt;strong&gt;AIC, BIC&lt;/strong&gt; values are pretty flat).&lt;/p&gt;
&lt;p&gt;We thus can infer that the price time series of Apple has significant trend that persists for more than 60 days and, since the daily log return time series appear to be uncorrelated, the daily log returns are subject to models not covered by autoregression (&lt;strong&gt;AR&lt;/strong&gt;).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><guid>https://buot.learning.io/posts/volatility-modelling-in-finance-part-1/</guid><pubDate>Mon, 13 Nov 2017 06:27:25 GMT</pubDate></item><item><title>Commodity Averaging Currency Swap Part 1</title><link>https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/</link><dc:creator>buot</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Commodity-Averaging-Currency-Swap-Part-1"&gt;Commodity Averaging Currency Swap Part 1&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Commodity-Averaging-Currency-Swap-Part-1"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id="Some-Lognormal-Relationships"&gt;Some Lognormal Relationships&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Some-Lognormal-Relationships"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;If we let $A$ and $B$ be two lognormally distributed random variables, where we define
$$
\begin{align}
&amp;amp;\rm{E}[A] = \bar{A},  &amp;amp;&amp;amp;\rm{E}[B] = \bar{B}\\
&amp;amp;\rm{Var}[\rm{log}~A] = \mathit{v}_A, &amp;amp;&amp;amp; \rm{Var}[\rm{log}~B] = \mathit{v}_B\\
&amp;amp;\rm{Cov}[\rm{log}~A, \rm{log}~B] = \mathit{v}_{AB}
\end{align}
$$
Now let's define a polynomial term
$$
C_{p,q} = A^p\cdot B^q
$$
for some constants $p, q$. Then because
$$
\rm{log}~C_{p,q} = p\cdot \rm{log}~A + q\cdot\rm{log}~B
$$
which is a linear combination of two normal distributions, i.e. another normal random  variable, with
$$
\rm{Var}[\rm{log}~C_{p,q}] = p^2 \mathit{v}_A + q^2\mathit{v}_B+2pq\mathit{v}_{AB}
$$
Meanwhile, we can infer that the expectation
$$
\displaystyle
\begin{align}
\rm{E}[A] = \bar{A}&amp;amp;=\rm{exp}~\left\{\rm{E}[\rm{log}~A]+\frac{1}{2}\rm{Var}~[\rm{log}~A]\right\}\\
&amp;amp;=\rm{exp}~\left\{\rm{E}[\rm{log}~A]+\frac{1}{2}\mathit{v}_A\right\}
\end{align}
$$
So we have
$$
\rm{E}[\rm{log}~A] = \rm{ln}\bar{A}-\frac{1}{2}\mathit{v}_A, \quad \rm{E}[\rm{log}~B] = \rm{ln}\bar{B}-\frac{1}{2}\mathit{v}_B
$$
Therefore
$$
\begin{align}
\mathrm{E}[\mathrm{log}~C_{p,q}] &amp;amp;= p\cdot \mathrm{ln}\bar{A} - \frac{1}{2}p\mathit{v}_A + q\cdot \mathrm{ln}\bar{B} - \frac{1}{2}q\mathit{v}_B\\
&amp;amp; = \mathrm{ln}\left(\bar{A}^p\bar{B}^q\right) - \frac{1}{2}\left(p\mathit{v}_A+q\mathit{v}_B\right)
\end{align}
$$
and we can derive the expectation of $C_{p,q}$ as
$$
\begin{align}
\mathrm{E}[C_{p,q}] &amp;amp;= \mathrm{exp}\left\{\mathrm{E}[\mathrm{log}~C_{p,q}] + \frac{1}{2}\mathrm{Var}[\mathrm{log}~C_{p,q}]\right\}\\
&amp;amp; = \mathrm{exp}\left\{\mathrm{ln}\left(\bar{A}^p\bar{B}^q\right) - \frac{1}{2}\left(p\mathit{v}_A+q\mathit{v}_B\right) + \frac{1}{2}p^2 \mathit{v}_A + q^2\mathit{v}_B+2pq\mathit{v}_{AB}\right\}\\
&amp;amp;=\bar{A}^p\bar{B}^q\mathrm{exp}\left\{\frac{1}{2}p(p-1)\mathit{v}_A + \frac{1}{2}q(q-1)\mathit{v}_B+2pq\mathit{v}_{AB}\right\}
\end{align}
$$
Similarly for its variance, using the definition of variance, it's readily seen that
$$
\begin{align}
\mathrm{Var}[C_{p,q}] &amp;amp;= \mathrm{E}[C_{p,q}^2] - \mathrm{E}^2[C_{p,q}]\\
&amp;amp;=  \mathrm{exp}\left\{2\mathrm{E}[\mathrm{log}~C_{p,q}] + 2\mathrm{Var}[\mathrm{log}~C_{p,q}]\right\}- \mathrm{exp}\left\{2\mathrm{E}[\mathrm{log}~C_{p,q}] + \mathrm{Var}[\mathrm{log}~C_{p,q}]\right\}\\
&amp;amp;=\mathrm{E}^2[C_{p,q}]~\left(\mathrm{exp}\left\{\mathrm{Var}[\mathrm{log}~C_{p,q}]\right\}-1\right)\\
&amp;amp;=\mathrm{E}^2[C_{p,q}]\left(\mathrm{exp}\left\{p^2 \mathit{v}_A + q^2\mathit{v}_B+2pq\mathit{v}_{AB}\right\} - 1\right)
\end{align}
$$
Now some special cases&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;$C_{p,0} = A^p$
$$
\mathrm{E}[A^p]=\bar{A}^p~\mathrm{exp}\left\{\frac{1}{2}p(p-1)\mathit{v}_A\right\}\\
\mathrm{Var}[\mathrm{log}~A^p] = p^2\mathit{v}_A
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;$C_{1,1}=AB$
$$
\mathrm{E}[AB]=\bar{A}\bar{B}~\mathrm{exp}(\mathit{v}_{AB})\\
\mathrm{Var}[\mathrm{log}~(AB)] = \mathit{v}_A + \mathit{v}_B + 2\mathit{v}_{AB}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;$C_{1,-1}=\frac{A}{B}$
$$
\mathrm{E}\left[\frac{A}{B}\right] = \frac{\bar{A}}{\bar{B}}\mathrm{exp}\left\{\mathit{v}_B-\mathit{v}_{AB}\right\}\\
\mathrm{Var}\left[\mathrm{log}~\frac{A}{B}\right] = \mathit{v}_A+\mathit{v}_B-2\mathit{v}_{AB}
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There is also a general formula for expectation of $Af(B)$ with $f$ some function, such that
$$
\mathrm{E}\left[Af(B)\right] = \mathrm{E}[A]\cdot\mathrm{E}[f(B\exp\{\mathit{v}_{AB}\})]
$$&lt;/p&gt;
&lt;h4 id="Some-Notations-and-Assumptions/Approximations"&gt;Some Notations and Assumptions/Approximations&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Some-Notations-and-Assumptions/Approximations"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;There are two economies, domestic, denoted as $d$, and foreign, denoted as $f$. &lt;/li&gt;
&lt;li&gt;In the domestic economy the risk-neutral measure is $P$; in the foreign market it is denoted as $Q$.&lt;/li&gt;
&lt;li&gt;Spot foreign exchange rate is $X(t)$ in domestic currency for $1$ unit of foreign currency, and is $Y(t)=1/X(t)$ in foreign currency to exchange for $1$ unit of domestic currency.&lt;/li&gt;
&lt;li&gt;At time $t$, we have a commodity asset with maturity at $T&amp;gt;t$, its price in domestic currency is denoted as $F(t, T)$, and its price in foreign currency is defined as $G(t, T)=F(t,T)Y(t)$&lt;/li&gt;
&lt;li&gt;We in general define $n+1$ uncorrelated Wiener process $\mathbf{W}(t) = \{W_i(t)\}$, i.e. $\langle \mathrm{d}W_i(t)~\mathrm{d}W_j(t) \rangle = 0$, for $i\neq j$. Naturally we consider correlated $n+1$ dimensional Wiener process under risk-neutral measure $P$, defined as $\mathbf{Z}(t) = \{Z_i(t) \}$ where $\mathbf{Z}(t) = \mathbf{C}\cdot \mathbf{W}(t)$, with $\mathbf{C}\cdot \mathbf{C}^\top = \mathbf{\rho}=[\rho_{ij}]$ the correlation matrix for $\mathbf{Z}(t)$. Hence we note that $\langle \mathrm{d}Z_i(t)~\mathrm{d}Z_j(t) \rangle = \rho_{ij}\mathrm{d}t$ &lt;/li&gt;
&lt;li&gt;Lastly we denote the instantaneous continuous interest rates in the domestic and foreign economy as $r_d(t), r_f(t)$ respectively.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="Foreign-Exchange-Dynamics"&gt;Foreign Exchange Dynamics&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Foreign-Exchange-Dynamics"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Under the domestic risk neutral measure $P$, the foreign exchange rate to obtain $1$ unit of foreign currency, $X(t)$, is governed by the SDE
$$
\frac{\mathrm{d}X(t)}{X(t)} = (r_d(t) - r_f(t))~\mathrm{d}t + \sigma_X(t)~\mathrm{d}Z_0(t)
$$
Note here that the process is &lt;strong&gt;log normal&lt;/strong&gt; and the log normal volatility $\sigma_X(t)$ is deterministic.&lt;/p&gt;
&lt;p&gt;The solution to this SDE 
$$
X(t) = X(0)~\exp\left\{\int_0^t\,\left(r_d(s)-r_f(s)-\frac{1}{2}\sigma_X^2(s)\right)\mathrm{d}s + \int_0^t\,\sigma_X(s)\mathrm{d}Z_0(s)\right\}
$$
is well understood. Indeed, as mentioned above, $X(t)$ is log normally distributed, with expectation 
$$
\mathrm{E}_P[X(t)] =X(0)~\exp\left\{\int_0^t\,\left(r_d(s)-r_f(s) \right) \mathrm{d}s \right\}
$$
and variance
$$
\begin{align}
&amp;amp;\mathrm{Var}_P[X(t)] =X^2(0)~\exp\left\{2\int_0^t\,\left(r_d(s)-r_f(s) \right) \mathrm{d}s \right\}\left(\exp\left\{\int_0^t\,\sigma_X^2(s)\mathrm{d}s\right\}-1\right)\\
&amp;amp;\mathrm{Var}_P[\log \,X(t)]  = \int_0^t\,\sigma_X^2(s)\mathrm{d}s
\end{align}
$$
Note that again everything is under domestic risk neutral measure $P$.&lt;/p&gt;
&lt;p&gt;Consider the foreign exchange rate in foreign currency to get $1$ unit of domestic currency, $Y(t)$. With Ito lemma, it's straightforward to see that
$$
\begin{align}
\mathrm{d}Y(t) &amp;amp; = \mathrm{d}\left(\frac{1}{X(t)}\right)\\
&amp;amp; = -\frac{1}{X^2(t)}\mathrm{d}X(t) + \frac{1}{2}~\frac{2}{X^3(t)}\langle\mathrm{d}X(t)~\mathrm{d}X(t)\rangle\\
&amp;amp; = Y(t)\left[-\left(r_d(t)-r_f(t)\right)\mathrm{d}t-\sigma_X(t)\mathrm{d}Z_0(t)+\sigma_X^2(t)\mathrm{d}t\right]\\
&amp;amp; = Y(t)\left[\left(r_f(t)-r_d(t)\right)\mathrm{d}t-\sigma_X(t)~\left(\mathrm{d}Z_0(t)-\sigma_X(t)\right)\right]
\end{align}
$$
If we define
$$
\tilde{Z_0}(t)=Z_0(t) - \int_0^t\,\sigma_X(s)\mathrm{d}s
$$
then by Girsanov theorem, $\tilde{Z}_0(t)$ is a standard Wiener process under measure $Q$, such that the Radon-Nikodym derivative is 
$$
\frac{\mathrm{d}Q(t)}{\mathrm{d}P(t)} = \exp\,\left\{\int_0^t\,\sigma_X(s)\mathrm{d}Z_0(s)-\frac{1}{2}\int_0^t\,\sigma_X^2(s)\mathrm{d}s\right\}
$$
Under this foreign risk neutral measure $Q$, the exchange rate $Y(t)$ is given by
$$
\frac{\mathrm{d}Y(t)}{Y(t)} = \left(r_f(t)-r_d(t)\right)\mathrm{d}t-\sigma_X(t)\mathrm{d}\tilde{Z}_0(t)
$$
The solution to this SDE is similarly given by
$$
Y(t) = Y(0)~\exp\left\{\int_0^t\,\left(r_f(s)-r_d(s)-\frac{1}{2}\sigma_X^2(s)\right)\mathrm{d}s - \int_0^t\,\sigma_X(s)\mathrm{d}\tilde{Z}_0(s)\right\}
$$
Since $Y(t)$ is a log normal, we observe that 
$$
\begin{align}
&amp;amp;\mathrm{E}_Q[Y(t)]=Y(0)\,\exp\left\{\int_0^t\,\left(r_f(s)-r_d(s)\right)\mathrm{d}s\right\}=\frac{1}{\mathrm{E}_P[X(t)]}\\
&amp;amp;\mathrm{Var}_Q[Y(t)] =Y^2(0)~\exp\left\{2\int_0^t\,\left(r_f(s)-r_d(s) \right) \mathrm{d}s \right\}\left(\exp\left\{\int_0^t\,\sigma_X^2(s)\mathrm{d}s\right\}-1\right)\\
&amp;amp;\mathrm{Var}_Q[\log \,Y(t)]  = \int_0^t\,\sigma_X^2(s)\mathrm{d}s = \mathrm{Var}_P[\log \, X(t)]
\end{align}
$$
Note that by Girsanov theorem we are able to change measures
$$
\mathrm{E}_Q[M] = \mathrm{E}_P[M\frac{\mathrm{d}Q}{\mathrm{d}P}]
$$
where $M$ is any stochastic function.&lt;/p&gt;
&lt;p&gt;By the formula for Radon-Nikodym derivative we see that
$$
\frac{\mathrm{d}Q}{\mathrm{d}P}=\frac{X(t)}{\mathrm{E}_P[X(t)]}, \qquad \frac{\mathrm{d}P}{\mathrm{d}Q}=\frac{Y(t)}{\mathrm{E}_Q[Y(t)]}
$$
It follows that
$$
\mathrm{E}_P[MX(t)] = \mathrm{E}_Q[M]\mathrm{E}_P[X(t)], \qquad \mathrm{E}_Q[MY(t)] = \mathrm{E}_P[M]\mathrm{E}_Q[Y(t)]
$$&lt;/p&gt;
&lt;h4 id="Commodity-Spot-Dynamics"&gt;Commodity Spot Dynamics&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Commodity-Spot-Dynamics"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Under the domestic risk neutral measure $P$ we assume that the commodity spot price $F(t, T)$ is governed by a drift-less $n$-factor log normal process:
$$
\frac{\mathrm{d}F(t, T)}{F(t, T)} = \sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}Z_i(t)
$$
where all the volatility functions are deterministic.&lt;/p&gt;
&lt;p&gt;Let $A(t, T) = \log \, F(t, T)$. By Ito's lemma,
$$
\begin{align}
\mathrm{d}A(t, T) &amp;amp;= \frac{1}{F(t, T)}\mathrm{d}F(t, T) -\frac{1}{2}\,\frac{1}{F^2(t, T)}\langle\mathrm{d}F(t, T)\,\mathrm{d}F(t, T)\rangle\\
&amp;amp;=\sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}Z_i(t)-\frac{1}{2}\sum_{i, j=1}^n\,\langle\sigma_i(t, T)\mathrm{d}Z_i(t, T)\,\sigma_j(t, T)\mathrm{d}Z_j(t, T)\rangle\\
&amp;amp;=-\frac{1}{2}\sum_{i,j=1}^n\,\sigma_i(t,T)\sigma_j(t,T)\rho_{ij} + \sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}Z_i(t)
\end{align}
$$
Taking integral and expanding $A(t, T)$ we can see that
$$
F(t, T)=F(0, T)\exp\,\left\{-\frac{1}{2}\int_0^t\,\underbrace{\sum_{i,j=1}^n\,\sigma_i(s,T)\sigma_j(s,T)\rho_{ij}}_{\sigma_F^2(s, T)}\mathrm{d}s + \sum_{i=1}^n\,\int_0^t\,\sigma_i(s,T)\mathrm{d}Z_i(s)\right\}
$$
where we call $\sigma_F(t, T)$ the instantaneous volatility of $F(t, T)$.&lt;/p&gt;
&lt;p&gt;It's not difficult to obtain the expectation and variance of logarithm:
$$
\begin{align}
&amp;amp; \mathrm{E}_P[F(t, T)] = F(0, T)\\
&amp;amp; \mathrm{Var}_P[\log F(t, T)] = \int_0^t\,\sum_{i,j=1}^n\,\sigma_i(s,T)\sigma_j(s,T)\rho_{ij}\mathrm{d}s=\int_0^t\,\sigma_F^2(s,T)\mathrm{d}s
\end{align}
$$
We then transfer to the foreign risk neutral measure, by letting
$$
\begin{align}
&amp;amp;\tilde{W_0}(t)=W_0(t)-\int_0^t\,\sigma_X(s)\mathrm{d}s, \quad \tilde{W}_i(t)=W_i(t), \forall i=1,\cdots, n\\
&amp;amp;\tilde{\mathbf{Z}}(t) = \mathbf{C}\cdot \tilde{\mathbf{W}}(t)
\end{align}
$$
As a result, under the foreign risk measure $Q$, $\tilde{\mathbf{W}}(t)$ is $n+1$-dimensional uncorrelated standard Wiener process, and $\tilde{\mathbf{Z}}(t)$ is correlated Wiener process with $\langle \mathrm{d}\tilde{Z}_i(t)\,\mathrm{d}\tilde{Z}_j(t) \rangle = \rho_{i,j} \mathrm{d}t$.&lt;/p&gt;
&lt;p&gt;Under the domestic risk neutral measure, the process for $F(t,T)$ is driftless, but it is not true under the &lt;strong&gt;foreign risk neutral measure $Q$&lt;/strong&gt;. In fact, under $Q$, we find
$$
\begin{align}
\frac{\mathrm{d}F(t, T)}{F(t, T)}&amp;amp;=\sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}Z_i(t)\\
&amp;amp;=\sum_{i=1}^n\,\sigma_i(t, T)\left(\sum_{j=0}^n\,C_{ij}\mathrm{d}W_j(t)\right)\\
&amp;amp;=\sum_{i=1}^n\,\sigma_i(t, T)\left(\sigma_X(t)C_{i0}\mathrm{d}t + \sum_{j=0}^n\,C_{ij}\mathrm{d}\tilde{W}_j(t)\right)\\
&amp;amp;=\left(\sum_{i=1}^n\,\rho_{i0}\sigma_i(t, T)\sigma_X(t)\right)\mathrm{d}t+\sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}\tilde{Z}_i(t)
\end{align}
$$
Now under foreign risk neutral pricing measure, we find the expectation and variance of logarithm:
$$
\begin{align}
\mathrm{E}_Q[F(t, T)] &amp;amp;= F(0, T)\exp\left\{\int_0^t\,\left(\sum_{i=1}^n\,\rho_{i0}\sigma_i(s, T)\sigma_X(s)\right)\mathrm{d}s\right\}\\
&amp;amp;=\mathrm{E}_P[F(t, T)]\exp\left\{-\mathrm{Cov}[\log F(t, T), \log Y(t)]\right\}\\
\mathrm{Var}_Q[\log F(t, T)]&amp;amp;=\int_0^t\,\sigma_F^2(s, T)\mathrm{d}s\\
&amp;amp;=\mathrm{Var}_P[\log F(t, T)]
\end{align}
$$&lt;/p&gt;
&lt;h4 id="Foreign-Currency-Denominated-Commodity-Spot-Dynamics"&gt;Foreign Currency Denominated Commodity Spot Dynamics&lt;a class="anchor-link" href="https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/#Foreign-Currency-Denominated-Commodity-Spot-Dynamics"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Now we consider $G(t, T)=F(t, T)Y(t)$. By Ito's lemma
$$
\mathrm{d}G(t, T) = \mathrm{d}F(t, T)\,Y(t)+F(t, T)\mathrm{d}Y(t) + \langle \mathrm{d}F(t, T)\,\mathrm{d}Y(t)\rangle
$$
Plugging SDE's for $F(t, T), Y(t)$ under the foreign risk neutral measure $Q$,
$$
\begin{align}
\frac{\mathrm{d}G(t, T)}{G(t, T)} =&amp;amp; \left(\sum_{i=1}^n\,\rho_{i0}\sigma_i(t, T)\sigma_X(t)\right)\mathrm{d}t+\sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}\tilde{Z}_i(t)+\left(r_f(t)-r_d(t)\right)\mathrm{d}t-\sigma_X(t)\mathrm{d}\tilde{Z}_0(t)\\
&amp;amp; - \left(\sum_{i=1}^n\,\rho_{i0}\sigma_i(t, T)\sigma_X(t)\right)\mathrm{d}t\\
=&amp;amp;\left(r_f(t)-r_d(t)\right)\mathrm{d}t-\sigma_X(t)\mathrm{d}\tilde{Z}_0(t) + \sum_{i=1}^n\,\sigma_i(t, T)\mathrm{d}\tilde{Z}_i(t)
\end{align}
$$
Hence, for foreign currency denominated commodity currency swap has solution under foreign risk neutral measure $Q$:
$$
\begin{align*}
G(t, T) =&amp;amp; G(0, T)\exp\left\{\int_0^t\,(r_f(s)-r_d(s))\mathrm{d}s\right\}\\
&amp;amp;\times\exp\left\{\underbrace{\frac{1}{2}\left(-\sum_{i=1}^n\,\int_0^t\,\rho_{i0}\sigma_X(s)\sigma_i(s, T)\mathrm{d}s + \sum_{i,j=1}^n\,\int_0^t\,\sigma_i(s, T)\sigma_j(s,T)\mathrm{d}s\right)}_{-\frac{1}{2}\sigma_G^2(t, T)}\right\}\\
&amp;amp;\times\exp\left\{\int_0^t\,\left(-\sigma_X(s)\mathrm{d}\tilde{Z}_0(s)+\sum_{i=1}^n\,\sigma_i(s, T)\mathrm{d}\tilde{Z}_i(s)\right)\right\}
\end{align*}
$$
Again, $G(t, T)$ is log normal under foreign risk neutral measure $Q$, with
$$
\begin{align}
\mathrm{E}_Q[G(t, T)] &amp;amp;= G(0, T)\exp\left\{\int_0^t\,\left(r_f(s)-r_d(s)\right)\mathrm{d}s\right\}\\
&amp;amp;=F(0, T)Y(0)\exp\left\{\int_0^t\,\left(r_f(s)-r_d(s)\right)\mathrm{d}s\right\}\\
&amp;amp;=\mathrm{E}_P[F(t, T)]\,\mathrm{E}_Q[Y(t)]\\
\mathrm{Var}_Q[\log G(t, T)] &amp;amp;= \int_0^t\,\sigma_G^2(s, T)\mathrm{d}s
\end{align}
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><guid>https://buot.learning.io/posts/commodity-averaging-currency-swap-part-1/</guid><pubDate>Mon, 13 Nov 2017 04:27:25 GMT</pubDate></item></channel></rss>